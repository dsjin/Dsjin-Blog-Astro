---
import type { Post } from '../assets/types/posts'
import ArticleList from '../components/ArticleList.vue'
import { getCollection, type CollectionEntry } from 'astro:content';

const { tag, page } = Astro.props

const start = (parseInt(page)-1)
const end = start + 5

const targetPosts = (await getCollection('blog', ({ data }: CollectionEntry<'blog'>) => data.tags.includes(tag))).map((value): Post => {
	return {
		...value.data,
		slug: value.slug,
		coverImage: value.data.coverImage?.src
	}
}).slice(start, end)

---

{
  targetPosts.map((post: Post) => <ArticleList info={post} />)
}
